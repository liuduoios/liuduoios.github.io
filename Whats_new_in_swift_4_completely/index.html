<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.2" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.2">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.2" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Mist',
    version: '6.0.2',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  
  <meta name="keywords" content="Hexo, NexT" />


<meta name="description" content="WWDC 2017 å¸¦æ¥äº†å¾ˆå¤šæƒŠå–œã€‚Swift 4 ä¹Ÿä¼´éšç€ Xcode 9 æµ‹è¯•ç‰ˆæ¥åˆ°äº†æˆ‘ä»¬çš„é¢å‰ï¼Œå¾ˆå¤šå¼ºå¤§çš„æ–°ç‰¹æ€§éå¸¸å€¼å¾—æˆ‘ä»¬æœŸå¾…åœ¨æ­£å¼é¡¹ç›®ä¸­å»ä½¿ç”¨å®ƒã€‚å› ä¸º Swift 4 æ˜¯å¼€æºçš„ï¼Œå¦‚æœä½ å…³æ³¨ swift-evolution è¿™ä¸ªé¡¹ç›®çš„è¯ï¼Œå°±åº”è¯¥å·²ç»æå‰äº†è§£åˆ°å®ƒçš„æ–°ç‰¹æ€§äº†ã€‚æœ¬æ–‡å‚è€ƒäº† WWDC 2017 ä»¥åŠå„ç§èµ„æ–™ï¼ŒæŠŠ Swift 4 çš„è¿™äº›æ–°ç‰¹æ€§ä¸€ä¸€åˆ—ä¸¾å‡ºæ¥åšä»‹ç»å’Œåˆ†æï¼Œè®©ä»–ä»¬æ¯«æ— ä¿ç•™åœ°">
<meta property="og:type" content="article">
<meta property="og:title" content="æœ€å…¨çš„ Swift 4 æ–°ç‰¹æ€§è§£æ">
<meta property="og:url" content="https://liuduoios.github.io/Whats_new_in_swift_4_completely/index.html">
<meta property="og:site_name" content="My Knowledge Library">
<meta property="og:description" content="WWDC 2017 å¸¦æ¥äº†å¾ˆå¤šæƒŠå–œã€‚Swift 4 ä¹Ÿä¼´éšç€ Xcode 9 æµ‹è¯•ç‰ˆæ¥åˆ°äº†æˆ‘ä»¬çš„é¢å‰ï¼Œå¾ˆå¤šå¼ºå¤§çš„æ–°ç‰¹æ€§éå¸¸å€¼å¾—æˆ‘ä»¬æœŸå¾…åœ¨æ­£å¼é¡¹ç›®ä¸­å»ä½¿ç”¨å®ƒã€‚å› ä¸º Swift 4 æ˜¯å¼€æºçš„ï¼Œå¦‚æœä½ å…³æ³¨ swift-evolution è¿™ä¸ªé¡¹ç›®çš„è¯ï¼Œå°±åº”è¯¥å·²ç»æå‰äº†è§£åˆ°å®ƒçš„æ–°ç‰¹æ€§äº†ã€‚æœ¬æ–‡å‚è€ƒäº† WWDC 2017 ä»¥åŠå„ç§èµ„æ–™ï¼ŒæŠŠ Swift 4 çš„è¿™äº›æ–°ç‰¹æ€§ä¸€ä¸€åˆ—ä¸¾å‡ºæ¥åšä»‹ç»å’Œåˆ†æï¼Œè®©ä»–ä»¬æ¯«æ— ä¿ç•™åœ°">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://or9vkv08s.bkt.clouddn.com/QQ20170609-181745@2x.png">
<meta property="og:image" content="http://or9vkv08s.bkt.clouddn.com/QQ20170609-181757@2x.png">
<meta property="og:image" content="http://or9vkv08s.bkt.clouddn.com/QQ20170609-182237@2x.png">
<meta property="og:image" content="http://or9vkv08s.bkt.clouddn.com/WechatIMG252.jpeg">
<meta property="article:published_time" content="2017-06-09T06:41:23.000Z">
<meta property="article:modified_time" content="2023-06-05T05:33:26.597Z">
<meta property="article:author" content="æ™¨æ›¦å¾®å…‰">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://or9vkv08s.bkt.clouddn.com/QQ20170609-181745@2x.png">



  <link rel="alternate" href="/atom.xml" title="My Knowledge Library" type="application/atom+xml" />




  <link rel="canonical" href="https://liuduoios.github.io/Whats_new_in_swift_4_completely/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>
  <title>æœ€å…¨çš„ Swift 4 æ–°ç‰¹æ€§è§£æ | My Knowledge Library</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

<meta name="generator" content="Hexo 6.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">My Knowledge Library</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ä¸ªäººåšå®¢</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-home"></i> <br />é¦–é¡µ</a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-th"></i> <br />åˆ†ç±»</a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />æ ‡ç­¾</a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />å½’æ¡£</a>
        </li>
      

      
    </ul>
  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://liuduoios.github.io/Whats_new_in_swift_4_completely/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My Knowledge Library">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">æœ€å…¨çš„ Swift 4 æ–°ç‰¹æ€§è§£æ</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-06-09T14:41:23+08:00">2017-06-09</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Swift/" itemprop="url" rel="index"><span itemprop="name">Swift</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/Whats_new_in_swift_4_completely/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/Whats_new_in_swift_4_completely/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/Whats_new_in_swift_4_completely/" class="leancloud_visitors" data-flag-title="æœ€å…¨çš„ Swift 4 æ–°ç‰¹æ€§è§£æ">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">54k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">54 mins.</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>WWDC 2017 å¸¦æ¥äº†å¾ˆå¤šæƒŠå–œã€‚Swift 4 ä¹Ÿä¼´éšç€ Xcode 9 æµ‹è¯•ç‰ˆæ¥åˆ°äº†æˆ‘ä»¬çš„é¢å‰ï¼Œå¾ˆå¤šå¼ºå¤§çš„æ–°ç‰¹æ€§éå¸¸å€¼å¾—æˆ‘ä»¬æœŸå¾…åœ¨æ­£å¼é¡¹ç›®ä¸­å»ä½¿ç”¨å®ƒã€‚å› ä¸º Swift 4 æ˜¯å¼€æºçš„ï¼Œå¦‚æœä½ å…³æ³¨ <code>swift-evolution</code> è¿™ä¸ªé¡¹ç›®çš„è¯ï¼Œå°±åº”è¯¥å·²ç»æå‰äº†è§£åˆ°å®ƒçš„æ–°ç‰¹æ€§äº†ã€‚æœ¬æ–‡å‚è€ƒäº† WWDC 2017 ä»¥åŠå„ç§èµ„æ–™ï¼ŒæŠŠ Swift 4 çš„è¿™äº›æ–°ç‰¹æ€§ä¸€ä¸€åˆ—ä¸¾å‡ºæ¥åšä»‹ç»å’Œåˆ†æï¼Œè®©ä»–ä»¬æ¯«æ— ä¿ç•™åœ°å±•ç°åœ¨ä½ çœ¼å‰ã€‚</p>
<h1 id="ä¸€ã€è¯­æ³•æ”¹è¿›"><a href="#ä¸€ã€è¯­æ³•æ”¹è¿›" class="headerlink" title="ä¸€ã€è¯­æ³•æ”¹è¿›"></a>ä¸€ã€è¯­æ³•æ”¹è¿›</h1><h2 id="extension-ä¸­å¯ä»¥è®¿é—®-private-çš„å±æ€§"><a href="#extension-ä¸­å¯ä»¥è®¿é—®-private-çš„å±æ€§" class="headerlink" title="extension ä¸­å¯ä»¥è®¿é—® private çš„å±æ€§"></a>extension ä¸­å¯ä»¥è®¿é—® private çš„å±æ€§</h2><p>è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Date</span>: <span class="title class_">Equatable</span>, <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> secondsSinceReferenceDate: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">==</span>(<span class="params">lhs</span>: <span class="type">Date</span>, <span class="params">rhs</span>: <span class="type">Date</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> lhs.secondsSinceReferenceDate <span class="operator">==</span> rhs.secondsSinceReferenceDate</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">&lt;</span>(<span class="params">lhs</span>: <span class="type">Date</span>, <span class="params">rhs</span>: <span class="type">Date</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> lhs.secondsSinceReferenceDate <span class="operator">&lt;</span> rhs.secondsSinceReferenceDate</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª Date ç»“æ„ä½“ï¼Œå¹¶å®ç° Equatable å’Œ Comparable åè®®ã€‚ä¸ºäº†è®©ä»£ç æ›´æ¸…æ™°ï¼Œå¯è¯»æ€§æ›´å¥½ï¼Œä¸€èˆ¬ä¼šæŠŠå¯¹åè®®çš„å®ç°æ”¾åœ¨å•ç‹¬çš„ extension ä¸­ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§éå¸¸ç¬¦åˆ Swift é£æ ¼çš„å†™æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Date</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> secondsSinceReferenceDate: <span class="type">Double</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Date</span>: <span class="title class_">Equatable</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">==</span>(<span class="params">lhs</span>: <span class="type">Date</span>, <span class="params">rhs</span>: <span class="type">Date</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> lhs.secondsSinceReferenceDate <span class="operator">==</span> rhs.secondsSinceReferenceDate</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">Date</span>: <span class="title class_">Comparable</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">&lt;</span>(<span class="params">lhs</span>: <span class="type">Date</span>, <span class="params">rhs</span>: <span class="type">Date</span>) -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> lhs.secondsSinceReferenceDate <span class="operator">&lt;</span> rhs.secondsSinceReferenceDate</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯åœ¨ Swift 3 ä¸­ï¼Œç¼–è¯‘å°±æŠ¥é”™äº†ï¼Œå› ä¸º extension ä¸­æ— æ³•è·å–åˆ° secondsSinceReferenceDate å±æ€§ï¼Œå› ä¸ºå®ƒæ˜¯ <code>private</code> çš„ã€‚äºæ˜¯åœ¨ Swift 3 ä¸­ï¼Œå¿…é¡»æŠŠ private æ”¹ä¸º fileprivateã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">struct Date &#123;</span><br><span class="line">    fileprivate let secondsSinceReferenceDate: Double</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¦‚æœç”¨ fileprivateï¼Œå±æ€§çš„ä½œç”¨åŸŸå°±ä¼šæ¯”æˆ‘ä»¬éœ€è¦çš„æ›´å¤§ï¼Œå¯èƒ½ä¼šä¸å°å¿ƒé€ æˆå±æ€§çš„æ»¥ç”¨ã€‚</p>
<p>åœ¨ Swift 4 ä¸­ï¼Œprivate çš„å±æ€§çš„ä½œç”¨åŸŸæ‰©å¤§åˆ°äº† extension ä¸­ï¼Œå¹¶ä¸”è¢«é™å®šåœ¨äº† struct å’Œ extension å†…éƒ¨ï¼Œè¿™æ ·å°±ä¸éœ€è¦å†æ”¹æˆ fileprivate äº†ï¼Œè¿™æ˜¯æœ€å¥½çš„ç»“æœã€‚</p>
<h2 id="ç±»å‹å’Œåè®®çš„ç»„åˆç±»å‹"><a href="#ç±»å‹å’Œåè®®çš„ç»„åˆç±»å‹" class="headerlink" title="ç±»å‹å’Œåè®®çš„ç»„åˆç±»å‹"></a>ç±»å‹å’Œåè®®çš„ç»„åˆç±»å‹</h2><p>è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Shakeable</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">shake</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">UIButton</span>: <span class="title class_">Shakeable</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">UISlider</span>: <span class="title class_">Shakeable</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">shakeEm</span>(<span class="params">controls</span>: [<span class="operator">???</span>]) &#123;</span><br><span class="line">    <span class="keyword">for</span> control <span class="keyword">in</span> controls <span class="keyword">where</span> control.state.isEnabled &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    control.shake()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ Swift 3 ä¸­ï¼Œè¿™é‡Œçš„ <code>???</code> åº”è¯¥å†™ä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœå†™ <code>UIControl</code>ï¼Œé‚£ä¹ˆ <code>control.shake()</code> å°±ä¼šæŠ¥é”™ï¼›å¦‚æœå†™ <code>Shakeable</code>ï¼Œé‚£ä¹ˆ <code>control.state.isEnabled</code> å°±ä¼šæŠ¥é”™ã€‚å…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">shakeEm</span>(<span class="params">controls</span>: [<span class="type">UIControl</span>]) &#123;</span><br><span class="line">    <span class="keyword">for</span> control <span class="keyword">in</span> controls <span class="keyword">where</span> control.isEnabled &#123;</span><br><span class="line">        <span class="keyword">if</span> control <span class="keyword">is</span> <span class="type">Shakeable</span> &#123;</span><br><span class="line">            (control <span class="keyword">as!</span> <span class="type">Shakeable</span>).shake()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å†™è™½ç„¶å¯ä»¥è·‘é€šäº†ï¼Œä½†æ˜¯å¾ˆä¸‘é™‹ã€‚</p>
<p>åœ¨ Swift 4 ä¸­ï¼Œå¯ä»¥æŠŠç±»å‹å’Œåè®®ç”¨ <code>&amp;</code> ç»„åˆåœ¨ä¸€èµ·ä½œä¸ºä¸€ä¸ªç±»å‹ä½¿ç”¨ï¼Œå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·å†™äº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Shakeable</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">shake</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">UIButton</span>: <span class="title class_">Shakeable</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">UISlider</span>: <span class="title class_">Shakeable</span> &#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">shakeEm</span>(<span class="params">controls</span>: [<span class="type">UIControl</span> &amp; <span class="type">Shakeable</span>]) &#123;</span><br><span class="line">    <span class="keyword">for</span> control <span class="keyword">in</span> controls <span class="keyword">where</span> control.state.isEnabled &#123;</span><br><span class="line">        control.shake()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠå®ƒå£°æ˜ä¸ºäº† <code>UIControl &amp; Shakeable</code> ç±»å‹ã€‚OKï¼Œåœ†æ»¡è§£å†³ã€‚</p>
<p>PS:<br>è¿™ä¸ªä»£ç ä¾‹å­æ˜¯ WWDC 2017 çš„ PPT ä¸­çš„ï¼Œä¸Šé¢çš„ä»£ç æœ‰ç‚¹é—®é¢˜ï¼Œcontrol.state.isEnabled è¿™å¥ä»£ç ä¸­ï¼Œstate æ˜¯æ²¡æœ‰ isEnabled è¿™ä¸ªå±æ€§çš„ï¼Œæ”¹ä¸º <code>control.isEnabled</code> å°±å¯ä»¥äº†ã€‚çœ‹æ¥è‹¹æœçš„å·¥ç¨‹å¸ˆåš PPT æœ‰æ—¶å€™è¿˜æ˜¯ä¸å¤ªä¸¥è°¨ã€‚</p>
<p>å¦å¤–ï¼ŒiOS SDK ä¸­çš„ API ä¹Ÿç”¨è¿™ä¸ªç‰¹æ€§åšäº†ä¼˜åŒ–ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Objective-C API</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSCandidateListTouchBarItem</span>&lt;<span class="title">CandidateType</span>&gt; : <span class="title">NSTouchBarItem</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">weak</span>) <span class="built_in">NSView</span> &lt;<span class="built_in">NSTextInputClient</span>&gt; *client;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ª API çš„ Objective-C ç‰ˆæœ¬æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå¯ä»¥çŸ¥é“ client å±æ€§æ—¢æ˜¯ä¸€ä¸ª NSViewï¼Œåˆç¬¦åˆ NSTextInputClient åè®®ã€‚ç„¶è€Œå®ƒå¯¹åº”çš„ Swift 3 ç‰ˆæœ¬ä¸ºï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NSCandidateListTouchBarItem</span>&lt;<span class="title class_">CandidateType</span>: <span class="title class_">AnyObject</span>&gt; : <span class="title class_">NSTouchBarItem</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> client: <span class="type">NSView</span>?</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»…ä»…æ˜¯ä¸€ä¸ª NSView ç±»å‹ &#x2F;(ã„’oã„’)&#x2F;~~</p>
<p>åœ¨ Swift 4 ä¸­ï¼Œè¿™ç±» API åšäº†ä¼˜åŒ–ï¼Œæ”¹æˆäº†ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NSCandidateListTouchBarItem</span>&lt;<span class="title class_">CandidateType</span>: <span class="title class_">AnyObject</span>&gt; : <span class="title class_">NSTouchBarItem</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> client: (<span class="type">NSView</span> &amp; <span class="type">NSTextInputClient</span>)<span class="operator">?</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ç±»å‹çš„å£°æ˜å°±æ›´åŠ ä¸¥è°¨äº†ã€‚</p>
<h2 id="Associated-Type-å¯ä»¥è¿½åŠ -Where-çº¦æŸè¯­å¥"><a href="#Associated-Type-å¯ä»¥è¿½åŠ -Where-çº¦æŸè¯­å¥" class="headerlink" title="Associated Type å¯ä»¥è¿½åŠ  Where çº¦æŸè¯­å¥"></a>Associated Type å¯ä»¥è¿½åŠ  Where çº¦æŸè¯­å¥</h2><p>åœ¨ Swift 4 ä¸­å¯ä»¥åœ¨ associatedtype åé¢å£°æ˜çš„ç±»å‹åè¿½åŠ  where è¯­å¥</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">associatedtype</span> <span class="type">Element</span> <span class="keyword">where</span> <span class="operator">&lt;</span>xxx<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸‹é¢æ˜¯ Swift 4 æ ‡å‡†åº“ä¸­ Sequence ä¸­ SubSequence çš„å£°æ˜ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Sequence</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Element</span> <span class="keyword">where</span> <span class="keyword">Self</span>.<span class="type">Element</span> <span class="operator">==</span> <span class="keyword">Self</span>.<span class="type">Iterator</span>.<span class="type">Element</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ƒé™å®šäº† Sequence ä¸­ Element è¿™ä¸ªç±»å‹å¿…é¡»å’Œ Iterator.Element çš„ç±»å‹ä¸€è‡´ã€‚</p>
<p>é€šè¿‡ where è¯­å¥å¯ä»¥å¯¹ç±»å‹æ·»åŠ æ›´å¤šçš„çº¦æŸï¼Œä½¿å…¶æ›´ä¸¥è°¨ï¼Œé¿å…åœ¨ä½¿ç”¨è¿™ä¸ªç±»å‹æ—¶åšå¤šä½™çš„ç±»å‹åˆ¤æ–­ã€‚</p>
<h2 id="æ–°çš„-Key-Paths-è¯­æ³•"><a href="#æ–°çš„-Key-Paths-è¯­æ³•" class="headerlink" title="æ–°çš„ Key Paths è¯­æ³•"></a>æ–°çš„ Key Paths è¯­æ³•</h2><p>å…ˆæ¥çœ‹çœ‹ Swift 3 ä¸­ Key Paths çš„å†™æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@objc</span>Members <span class="keyword">class</span> <span class="title class_">Kid</span>: <span class="title class_">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">dynamic</span> <span class="keyword">var</span> nickname: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">dynamic</span> <span class="keyword">var</span> age: <span class="type">Double</span> <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">dynamic</span> <span class="keyword">var</span> friends: [<span class="type">Kid</span>] <span class="operator">=</span> []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ben <span class="operator">=</span> <span class="type">Kid</span>(nickname: <span class="string">&quot;Benji&quot;</span>, age: <span class="number">5.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> kidsNameKeyPath <span class="operator">=</span> <span class="keyword">#keyPath</span>(<span class="type">Kid</span>.nickname)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> name <span class="operator">=</span> ben.valueForKeyPath(kidsNameKeyPath)</span><br><span class="line">ben.setValue(<span class="string">&quot;Ben&quot;</span>, forKeyPath: kidsNameKeyPath)</span><br></pre></td></tr></table></figure>

<p>Swift 4 ä¸­åˆ›å»ºä¸€ä¸ª KeyPath ç”¨ <code>\</code> ä½œä¸ºå¼€å¤´ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\Kid.nickname</span><br></pre></td></tr></table></figure>

<p>å½“ç¼–è¯‘å™¨å¯ä»¥æ¨å¯¼å‡ºç±»å‹æ—¶ï¼Œå¯ä»¥çœç•¥åŸºç¡€ç±»å‹éƒ¨åˆ†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\.nickname</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç åœ¨ Swift 4 ä¸­å°±å¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">struct Kid &#123;</span><br><span class="line">    var nickname: String = &quot;&quot;</span><br><span class="line">    var age: Double = 0.0</span><br><span class="line">    var friends: [Kid] = []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var ben = Kid(nickname: &quot;Benji&quot;, age: 8, friends: [])</span><br><span class="line"></span><br><span class="line">let name = ben[keyPath: \Kid.nickname]</span><br><span class="line">ben[keyPath: \Kid.nickname] = &quot;BigBen&quot;</span><br></pre></td></tr></table></figure>

<p>ç›¸æ¯” Swift 3ï¼ŒSwift 4 çš„ Key Paths å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ol>
<li>ç±»å‹å¯ä»¥å®šä¹‰ä¸º classã€struct</li>
<li>å®šä¹‰ç±»å‹æ—¶æ— éœ€åŠ ä¸Š @objcMembersã€dynamic ç­‰å…³é”®å­—</li>
<li>æ€§èƒ½æ›´å¥½</li>
<li>ç±»å‹å®‰å…¨å’Œç±»å‹æ¨æ–­ï¼Œä¾‹å¦‚ <code>ben.valueForKeyPath(kidsNameKeyPath)</code> è¿”å›çš„ç±»å‹æ˜¯ Anyï¼Œ<code>ben[keyPath: \Kid.nickname]</code> ç›´æ¥è¿”å› String ç±»å‹</li>
<li>å¯ä»¥åœ¨æ‰€æœ‰å€¼ç±»å‹ä¸Šä½¿ç”¨</li>
</ol>
<h2 id="ä¸‹æ ‡æ”¯æŒæ³›å‹"><a href="#ä¸‹æ ‡æ”¯æŒæ³›å‹" class="headerlink" title="ä¸‹æ ‡æ”¯æŒæ³›å‹"></a>ä¸‹æ ‡æ”¯æŒæ³›å‹</h2><p>æœ‰æ—¶å€™ä¼šå†™ä¸€äº›æ•°æ®å®¹å™¨ï¼ŒSwift æ”¯æŒé€šè¿‡ä¸‹æ ‡æ¥è¯»å†™å®¹å™¨ä¸­çš„æ•°æ®ï¼Œä½†æ˜¯å¦‚æœå®¹å™¨ç±»ä¸­çš„æ•°æ®ç±»å‹å®šä¹‰ä¸ºæ³›å‹ï¼Œä»¥å‰çš„ä¸‹æ ‡è¯­æ³•å°±åªèƒ½è¿”å› Anyï¼Œåœ¨å–å‡ºå€¼åéœ€è¦ç”¨ <code>as?</code> æ¥è½¬æ¢ç±»å‹ã€‚Swift 4 å®šä¹‰ä¸‹æ ‡ä¹Ÿå¯ä»¥ä½¿ç”¨æ³›å‹äº†ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">GenericDictionary</span>&lt;<span class="title class_">Key</span>: <span class="title class_">Hashable</span>, <span class="title class_">Value</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> data: [<span class="type">Key</span>: <span class="type">Value</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">init</span>(<span class="params">data</span>: [<span class="params">Key</span>: <span class="type">Value</span>]) &#123;</span><br><span class="line">        <span class="keyword">self</span>.data <span class="operator">=</span> data</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">subscript</span>&lt;<span class="type">T</span>&gt;(<span class="params">key</span>: <span class="type">Key</span>) -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">        <span class="keyword">return</span> data[key] <span class="keyword">as?</span> <span class="type">T</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dictionary <span class="operator">=</span> <span class="type">GenericDictionary</span>(data: [<span class="string">&quot;Name&quot;</span>: <span class="string">&quot;Xiaoming&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> name: <span class="type">String</span>? <span class="operator">=</span> dictionary[<span class="string">&quot;Name&quot;</span>] <span class="comment">// ä¸éœ€è¦å†å†™ as? String</span></span><br></pre></td></tr></table></figure>

<h1 id="äºŒã€å­—ç¬¦ä¸²"><a href="#äºŒã€å­—ç¬¦ä¸²" class="headerlink" title="äºŒã€å­—ç¬¦ä¸²"></a>äºŒã€å­—ç¬¦ä¸²</h1><h2 id="Unicode-å­—ç¬¦ä¸²åœ¨è®¡ç®—-count-æ—¶çš„æ­£ç¡®æ€§æ”¹å–„"><a href="#Unicode-å­—ç¬¦ä¸²åœ¨è®¡ç®—-count-æ—¶çš„æ­£ç¡®æ€§æ”¹å–„" class="headerlink" title="Unicode å­—ç¬¦ä¸²åœ¨è®¡ç®— count æ—¶çš„æ­£ç¡®æ€§æ”¹å–„"></a>Unicode å­—ç¬¦ä¸²åœ¨è®¡ç®— count æ—¶çš„æ­£ç¡®æ€§æ”¹å–„</h2><p>åœ¨ Unicode ä¸­ï¼Œæœ‰äº›å­—ç¬¦æ˜¯ç”±å‡ ä¸ªå…¶å®ƒå­—ç¬¦ç»„æˆçš„ï¼Œæ¯”å¦‚ <code>Ã©</code> è¿™ä¸ªå­—ç¬¦ï¼Œå®ƒå¯ä»¥ç”¨ <code>\u&#123;E9&#125;</code> æ¥è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ç”¨ e å­—ç¬¦å’Œä¸Šé¢ä¸€æ’‡å­—ç¬¦ç»„åˆåœ¨ä¸€èµ·è¡¨ç¤º <code>\u&#123;65&#125;\u&#123;301&#125;</code>ã€‚</p>
<p>è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> family <span class="operator">=</span> <span class="string">&quot;ğŸ‘©&quot;</span></span><br><span class="line">family <span class="operator">+=</span> <span class="string">&quot;<span class="subst">\u&#123;200D&#125;</span>ğŸ‘©&quot;</span></span><br><span class="line">family <span class="operator">+=</span> <span class="string">&quot;<span class="subst">\u&#123;200D&#125;</span>ğŸ‘§&quot;</span> </span><br><span class="line">family <span class="operator">+=</span> <span class="string">&quot;<span class="subst">\u&#123;200D&#125;</span>ğŸ‘¦&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(family)</span><br><span class="line"><span class="built_in">print</span>(family.characters.count)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ª family æ˜¯ä¸€ä¸ªç”±å¤šä¸ªå­—ç¬¦ç»„åˆæˆçš„å­—ç¬¦ï¼Œæ‰“å°å‡ºæ¥çš„ç»“æœä¸º ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ã€‚ä¸Šé¢çš„ä»£ç åœ¨ Swift 3 ä¸­æ‰“å°çš„ count æ•°æ˜¯ 4ï¼Œåœ¨ Swift 4 ä¸­æ‰“å°å‡ºçš„ count æ˜¯ 1ã€‚</p>
<h2 id="æ›´å¿«çš„å­—ç¬¦å¤„ç†é€Ÿåº¦"><a href="#æ›´å¿«çš„å­—ç¬¦å¤„ç†é€Ÿåº¦" class="headerlink" title="æ›´å¿«çš„å­—ç¬¦å¤„ç†é€Ÿåº¦"></a>æ›´å¿«çš„å­—ç¬¦å¤„ç†é€Ÿåº¦</h2><p>Swift 4 çš„å­—ç¬¦ä¸²ä¼˜åŒ–äº†åº•å±‚å®ç°ï¼Œå¯¹äºè‹±è¯­ã€æ³•è¯­ã€å¾·è¯­ã€è¥¿ç­ç‰™è¯­çš„å¤„ç†é€Ÿåº¦æé«˜äº† 3.5 å€ã€‚</p>
<p><img src="http://or9vkv08s.bkt.clouddn.com/QQ20170609-181745@2x.png"></p>
<p>å¯¹äºç®€ä½“ä¸­æ–‡ã€æ—¥è¯­çš„å¤„ç†é€Ÿåº¦æé«˜äº† 2.5 å€ã€‚</p>
<p><img src="http://or9vkv08s.bkt.clouddn.com/QQ20170609-181757@2x.png"></p>
<h2 id="å»æ‰-characters"><a href="#å»æ‰-characters" class="headerlink" title="å»æ‰ characters"></a>å»æ‰ characters</h2><p>Swift 3 ä¸­çš„ String éœ€è¦é€šè¿‡ characters å»è°ƒç”¨çš„å±æ€§æ–¹æ³•ï¼Œåœ¨ Swift 4 ä¸­å¯ä»¥é€šè¿‡ String å¯¹è±¡æœ¬èº«ç›´æ¥è°ƒç”¨ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let values = &quot;one,two,three...&quot;</span><br><span class="line">var i = values.characters.startIndex</span><br><span class="line"></span><br><span class="line">while let comma = values.characters[i...&lt;values.characters.endIndex].index(of: &quot;,&quot;) &#123;</span><br><span class="line">    if values.characters[i..&lt;comma] == &quot;two&quot; &#123;</span><br><span class="line">        print(&quot;found it!&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    i = values.characters.index(after: comma)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Swift 4 å¯ä»¥æŠŠä¸Šé¢ä»£ç ä¸­çš„æ‰€æœ‰çš„ characters éƒ½å»æ‰ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let values = &quot;one,two,three...&quot;</span><br><span class="line">var i = values.startIndex</span><br><span class="line"></span><br><span class="line">while let comma = values[i...&lt;values.endIndex].index(of: &quot;,&quot;) &#123;</span><br><span class="line">    if values[i..&lt;comma] == &quot;two&quot; &#123;</span><br><span class="line">        print(&quot;found it!&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    i = values.index(after: comma)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="One-sided-Slicing"><a href="#One-sided-Slicing" class="headerlink" title="One-sided Slicing"></a>One-sided Slicing</h2><p>Swift 4 æ–°å¢äº†ä¸€ä¸ªè¯­æ³•ç³–å¯ä»¥å¯¹å­—ç¬¦ä¸²è¿›è¡Œå•ä¾§è¾¹ç•Œå–å­ä¸²ã€‚</p>
<p>Swift 3:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let values = &quot;abcdefg&quot;</span><br><span class="line">let startSlicingIndex = values.index(values.startIndex, offsetBy: 3)</span><br><span class="line">let subvalues = values[startSlicingIndex..&lt;values.endIndex]</span><br><span class="line">// defg</span><br></pre></td></tr></table></figure>

<p>Swift 4:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let values = &quot;abcdefg&quot;</span><br><span class="line">let startSlicingIndex = values.index(values.startIndex, offsetBy: 3)</span><br><span class="line">let subvalues = values[startSlicingIndex...] // One-sided Slicing</span><br><span class="line">// defg</span><br></pre></td></tr></table></figure>

<h2 id="String-å½“åš-Collection-æ¥ç”¨"><a href="#String-å½“åš-Collection-æ¥ç”¨" class="headerlink" title="String å½“åš Collection æ¥ç”¨"></a>String å½“åš Collection æ¥ç”¨</h2><p>Swift 4 ä¸­ String å¯ä»¥å½“åš Collection æ¥ç”¨ï¼Œå¹¶ä¸æ˜¯å› ä¸º String å®ç°äº† Collection åè®®ï¼Œè€Œæ˜¯ String æœ¬èº«å¢åŠ äº†å¾ˆå¤š Collection åè®®ä¸­çš„æ–¹æ³•ï¼Œä½¿å¾— String åœ¨ä½¿ç”¨æ—¶çœ‹ä¸Šå»å°±æ˜¯ä¸ª Collectionã€‚ä¾‹å¦‚ï¼š</p>
<p>ç¿»è½¬å­—ç¬¦ä¸²ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> abc: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;abc&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="type">String</span>(abc.reversed()))</span><br><span class="line"><span class="comment">// cba</span></span><br></pre></td></tr></table></figure>

<p>éå†å­—ç¬¦ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> abc: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;abc&quot;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> abc &#123;</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">a</span></span><br><span class="line"><span class="comment">b</span></span><br><span class="line"><span class="comment">c</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>Mapã€Filterã€Reduce:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map</span></span><br><span class="line"><span class="keyword">let</span> abc: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;abc&quot;</span></span><br><span class="line"><span class="keyword">_</span> <span class="operator">=</span> abc.map &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="variable">$0</span>.description)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// filter</span></span><br><span class="line"><span class="keyword">let</span> filtered <span class="operator">=</span> abc.filter &#123; <span class="variable">$0</span> <span class="operator">==</span> <span class="string">&quot;b&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// reduce</span></span><br><span class="line"><span class="keyword">let</span> result <span class="operator">=</span> abc.reduce(<span class="string">&quot;1&quot;</span>) &#123; (result, c) -&gt; <span class="type">String</span> <span class="keyword">in</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line">    <span class="keyword">return</span> result <span class="operator">+</span> <span class="type">String</span>(c)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>

<h2 id="Substring"><a href="#Substring" class="headerlink" title="Substring"></a>Substring</h2><p><img src="http://or9vkv08s.bkt.clouddn.com/QQ20170609-182237@2x.png"></p>
<p>åœ¨ Swift ä¸­ï¼ŒString çš„èƒŒåæœ‰ä¸ª Owner Object æ¥è·Ÿè¸ªå’Œç®¡ç†è¿™ä¸ª Stringï¼ŒString å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ç”±å†…å­˜å…¶å®åœ°å€ã€å­—ç¬¦æ•°ã€æŒ‡å‘ Owner Object æŒ‡é’ˆç»„æˆã€‚Owner Object æŒ‡é’ˆæŒ‡å‘ Owner Object å¯¹è±¡ï¼ŒOwner Object å¯¹è±¡æŒæœ‰ String Bufferã€‚å½“å¯¹ String åšå–å­å­—ç¬¦ä¸²æ“ä½œæ—¶ï¼Œå­å­—ç¬¦ä¸²çš„ Owner Object æŒ‡é’ˆä¼šå’ŒåŸå­—ç¬¦ä¸²æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å­å­—ç¬¦ä¸²çš„ Owner Object ä¼šæŒæœ‰åŸ String çš„ Bufferã€‚å½“åŸå­—ç¬¦ä¸²é”€æ¯æ—¶ï¼Œç”±äºåŸå­—ç¬¦ä¸²çš„ Buffer è¢«å­å­—ç¬¦ä¸²çš„ Owner Object æŒæœ‰äº†ï¼ŒåŸå­—ç¬¦ä¸² Buffer å¹¶ä¸ä¼šé‡Šæ”¾ï¼Œé€ æˆæå¤§çš„å†…å­˜æµªè´¹ã€‚</p>
<p>åœ¨ Swift 4 ä¸­ï¼Œåšå–å­ä¸²æ“ä½œçš„ç»“æœæ˜¯ä¸€ä¸ª Substring ç±»å‹ï¼Œå®ƒæ— æ³•ç›´æ¥èµ‹å€¼ç»™éœ€è¦ String ç±»å‹çš„åœ°æ–¹ã€‚å¿…é¡»ç”¨ String(<substring>) åŒ…ä¸€å±‚ï¼Œç³»ç»Ÿä¼šé€šè¿‡å¤åˆ¶åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œè¿™æ ·åŸå­—ç¬¦ä¸²åœ¨é”€æ¯æ—¶ï¼ŒåŸå­—ç¬¦ä¸²çš„ Buffer å°±å¯ä»¥å®Œå…¨é‡Šæ”¾äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let big = downloadHugeString()</span><br><span class="line">let small = extractTinyString(from: big)</span><br><span class="line"></span><br><span class="line">mainView.titleLabel.text = small // Swift 4 ç¼–è¯‘æŠ¥é”™</span><br><span class="line"></span><br><span class="line">mainView.titleLabel.text = String(small) // ç¼–è¯‘é€šè¿‡</span><br></pre></td></tr></table></figure>

<h2 id="å¤šè¡Œå­—ç¬¦ä¸²å­—é¢é‡"><a href="#å¤šè¡Œå­—ç¬¦ä¸²å­—é¢é‡" class="headerlink" title="å¤šè¡Œå­—ç¬¦ä¸²å­—é¢é‡"></a>å¤šè¡Œå­—ç¬¦ä¸²å­—é¢é‡</h2><p>Swift 3 ä¸­å†™å¾ˆé•¿çš„å­—ç¬¦ä¸²åªèƒ½å†™åœ¨ä¸€è¡Œã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">tellJoke</span>(<span class="params">name</span>: <span class="type">String</span>, <span class="params">character</span>: <span class="type">Character</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> punchline <span class="operator">=</span> name.filter &#123; <span class="variable">$0</span> <span class="operator">!=</span> character &#125;</span><br><span class="line">    <span class="keyword">let</span> n <span class="operator">=</span> name.count <span class="operator">-</span> punchline.count</span><br><span class="line">    <span class="keyword">let</span> joke <span class="operator">=</span> <span class="string">&quot;Q: Why does <span class="subst">\(name)</span> have <span class="subst">\(n)</span> <span class="subst">\(character)</span>&#x27;s in their name?<span class="subst">\n</span>A: I don&#x27;t know, why does <span class="subst">\(name)</span> have <span class="subst">\(n)</span> <span class="subst">\(character)</span>&#x27;s in their name?<span class="subst">\n</span>Q: Because otherwise they&#x27;d be called <span class="subst">\(punchline)</span>.&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(joke)</span><br><span class="line">&#125;</span><br><span class="line">tellJoke(name: <span class="string">&quot;Edward Woodward&quot;</span>, character: <span class="string">&quot;d&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å­—ç¬¦ä¸²ä¸­é—´æœ‰æ¢è¡Œåªèƒ½é€šè¿‡æ·»åŠ  <code>\n</code> å­—ç¬¦æ¥ä»£è¡¨æ¢è¡Œã€‚ </p>
<p>Swift 4 å¯ä»¥æŠŠå­—ç¬¦ä¸²å†™åœ¨ä¸€å¯¹ <code>&quot;&quot;&quot;</code> ä¸­ï¼Œè¿™æ ·å­—ç¬¦ä¸²å°±å¯ä»¥å†™æˆå¤šè¡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">func tellJoke(name: String, character: Character) &#123;</span><br><span class="line">    let punchline = name.filter &#123; $0 != character &#125;</span><br><span class="line">    let n = name.count - punchline.count</span><br><span class="line">    let joke = &quot;&quot;&quot;</span><br><span class="line">        Q: Why does \(name) have \(n) \(character)&#x27;s in their name?</span><br><span class="line">        A: I don&#x27;t know, why does \(name) have \(n) \(character)&#x27;s in their name?</span><br><span class="line">        Q: Because otherwise they&#x27;d be called \(punchline).</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">    print(joke)</span><br><span class="line">&#125;</span><br><span class="line">tellJoke(name: &quot;Edward Woodward&quot;, character: &quot;d&quot;)</span><br></pre></td></tr></table></figure>

<h1 id="ä¸‰ã€Swift-æ ‡å‡†åº“"><a href="#ä¸‰ã€Swift-æ ‡å‡†åº“" class="headerlink" title="ä¸‰ã€Swift æ ‡å‡†åº“"></a>ä¸‰ã€Swift æ ‡å‡†åº“</h1><h2 id="Encoding-and-Decoding"><a href="#Encoding-and-Decoding" class="headerlink" title="Encoding and Decoding"></a>Encoding and Decoding</h2><p>å½“éœ€è¦å°†ä¸€ä¸ªå¯¹è±¡æŒä¹…åŒ–æ—¶ï¼Œéœ€è¦æŠŠè¿™ä¸ªå¯¹è±¡åºåˆ—åŒ–ï¼Œå¾€å¸¸çš„åšæ³•æ˜¯å®ç° NSCoding åè®®ï¼Œå†™è¿‡çš„äººåº”è¯¥éƒ½çŸ¥é“å®ç° NSCoding åè®®çš„ä»£ç å†™èµ·æ¥å¾ˆç—›è‹¦ï¼Œå°¤å…¶æ˜¯å½“å±æ€§éå¸¸å¤šçš„æ—¶å€™ã€‚å‡ å¹´å‰æœ‰ä¸€ä¸ªå·¥å…·èƒ½è‡ªåŠ¨ç”Ÿæˆ Objective-C çš„å®ç° NSCoding åè®®ä»£ç ï¼Œå½“æ—¶ç”¨ç€è¿˜ä¸é”™ï¼Œä½†åæ¥è¿™ä¸ªå·¥å…·å·²ç»æ²¡æœ‰äººç»´æŠ¤å¾ˆä¹…äº†ï¼Œè€Œä¸”ä¸æ”¯æŒ Swiftã€‚</p>
<p>Swift 4 ä¸­å¼•å…¥äº† <code>Codable</code> å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Language</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> version: <span class="type">Int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æƒ³å°†è¿™ä¸ª Language å¯¹è±¡çš„å®ä¾‹æŒä¹…åŒ–ï¼Œåªéœ€è¦è®© Language ç¬¦åˆ Codable åè®®å³å¯ï¼ŒLanguage ä¸­ä¸ç”¨å†™åˆ«çš„ä»£ç ã€‚ç¬¦åˆäº† Codable åè®®ä»¥åï¼Œå¯ä»¥é€‰æ‹©æŠŠå¯¹è±¡ encode æˆ JSON æˆ–è€… PropertyListã€‚</p>
<p>Encode æ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let swift = Language(name: &quot;Swift&quot;, version: 4)</span><br><span class="line">if let encoded = try? JSONEncoder().encode(swift) &#123;</span><br><span class="line">    // æŠŠ encoded ä¿å­˜èµ·æ¥</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Decode æ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if let decoded = try? JSONDecoder().decode(Language.self, from: encoded) &#123;</span><br><span class="line">    print(decoded.name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Sequence-æ”¹è¿›"><a href="#Sequence-æ”¹è¿›" class="headerlink" title="Sequence æ”¹è¿›"></a>Sequence æ”¹è¿›</h2><p>Swift 3:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">protocol Sequence &#123;</span><br><span class="line">    associatedtype Iterator: IteratorProtocol</span><br><span class="line">    func makeIterator() -&gt; Iterator</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Swift 4:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">protocol Sequence &#123;</span><br><span class="line">    associatedtype Element</span><br><span class="line">    associatedtype Iterator: IteratorProtocol where Iterator.Element == Element</span><br><span class="line">    func makeIterator() -&gt; Iterator</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±äº Swift 4 ä¸­çš„ associatedtype æ”¯æŒè¿½åŠ  where è¯­å¥ï¼Œæ‰€ä»¥ Sequence åšäº†è¿™æ ·çš„æ”¹è¿›ã€‚<br>Swift 4 ä¸­è·å– Sequence çš„å…ƒç´ ç±»å‹å¯ä»¥ä¸ç”¨ Iterator.Elementï¼Œè€Œæ˜¯ç›´æ¥å– Elementã€‚</p>
<p>SubSequence ä¹Ÿåšäº†ä¿®æ”¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">protocol Sequence &#123;</span><br><span class="line">    associatedtype SubSequence: Sequence </span><br><span class="line">        where SubSequence.SubSequence == SubSequence,</span><br><span class="line">              SubSequence.Element == Element</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ where è¯­å¥çš„é™å®šï¼Œä¿è¯äº†ç±»å‹æ­£ç¡®ï¼Œé¿å…åœ¨ä½¿ç”¨ Sequence æ—¶åšä¸€äº›ä¸å¿…è¦çš„ç±»å‹åˆ¤æ–­ã€‚</p>
<p>Collection ä¹Ÿæœ‰ä¸€äº›ç±»ä¼¼çš„ä¿®æ”¹ã€‚</p>
<h2 id="Protocol-oriented-integers"><a href="#Protocol-oriented-integers" class="headerlink" title="Protocol-oriented integers"></a>Protocol-oriented integers</h2><p>æ•´æ•°ç±»å‹ç¬¦åˆçš„åè®®æœ‰ä¿®æ”¹ï¼Œæ–°å¢äº† <code>FixedWidthInteger</code> ç­‰åè®®ï¼Œå…·ä½“çš„åè®®ç»§æ‰¿å…³ç³»å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">                +-------------+   +-------------+</span><br><span class="line">        +------&gt;+   Numeric   |   | Comparable  |</span><br><span class="line">        |       |   (+,-,*)   |   | (==,&lt;,&gt;,...)|</span><br><span class="line">        |       +------------++   +---+---------+</span><br><span class="line">        |                     ^       ^</span><br><span class="line">+-------+------------+        |       |</span><br><span class="line">|    SignedNumeric   |      +-+-------+-----------+</span><br><span class="line">|     (unary -)      |      |    BinaryInteger    |</span><br><span class="line">+------+-------------+      |(words,%,bitwise,...)|</span><br><span class="line">       ^                    ++---+-----+----------+</span><br><span class="line">       |         +-----------^   ^     ^---------------+</span><br><span class="line">       |         |               |                     |</span><br><span class="line">+------+---------++    +---------+---------------+  +--+----------------+</span><br><span class="line">|  SignedInteger  |    |  FixedWidthInteger      |  |  UnsignedInteger  |</span><br><span class="line">|                 |    |(endianness,overflow,...)|  |                   |</span><br><span class="line">+---------------+-+    +-+--------------------+--+  +-+-----------------+</span><br><span class="line">                ^        ^                    ^       ^</span><br><span class="line">                |        |                    |       |</span><br><span class="line">                |        |                    |       |</span><br><span class="line">               ++--------+-+                +-+-------+-+</span><br><span class="line">               |Int family |-+              |UInt family|-+</span><br><span class="line">               +-----------+ |              +-----------+ |</span><br><span class="line">                 +-----------+                +-----------+</span><br></pre></td></tr></table></figure>

<h2 id="Dictionary-and-Set-enhancements"><a href="#Dictionary-and-Set-enhancements" class="headerlink" title="Dictionary and Set enhancements"></a>Dictionary and Set enhancements</h2><p>è¿™é‡Œç®€å•åˆ—ä¸€ä¸‹ Dictionary å’Œ Set å¢å¼ºäº†å“ªäº›åŠŸèƒ½ï¼š</p>
<ol>
<li>é€šè¿‡ Sequence æ¥åˆå§‹åŒ–</li>
<li>å¯ä»¥åŒ…å«é‡å¤çš„ Key</li>
<li>Filter çš„ç»“æœçš„ç±»å‹å’ŒåŸç±»å‹ä¸€è‡´</li>
<li>Dictionary çš„ mapValues æ–¹æ³•</li>
<li>Dictionary çš„é»˜è®¤å€¼</li>
<li>Dictionary å¯ä»¥åˆ†ç»„</li>
<li>Dictionary å¯ä»¥ç¿»è½¬</li>
</ol>
<h2 id="NSNumber-bridging-and-Numeric-types"><a href="#NSNumber-bridging-and-Numeric-types" class="headerlink" title="NSNumber bridging and Numeric types"></a>NSNumber bridging and Numeric types</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let n = NSNumber(value: 999)</span><br><span class="line">let v = n as? UInt8 // Swift 4: nil, Swift 3: 231</span><br></pre></td></tr></table></figure>

<p>åœ¨ Swift 4 ä¸­ï¼ŒæŠŠä¸€ä¸ªå€¼ä¸º 999 çš„ NSNumber è½¬æ¢ä¸º UInt8 åï¼Œèƒ½æ­£ç¡®çš„è¿”å› <code>nil</code>ï¼Œè€Œåœ¨ Swift 3 ä¸­ä¼šä¸å¯é¢„æ–™çš„è¿”å› 231ã€‚</p>
<h2 id="MutableCollection-swapAt"><a href="#MutableCollection-swapAt" class="headerlink" title="MutableCollection.swapAt(::)"></a>MutableCollection.swapAt(<em>:</em>:)</h2><p>MutableCollection ç°åœ¨æœ‰äº†ä¸€ä¸ªæ–°æ–¹æ³• swapAt(<em>:</em>:) ç”¨æ¥äº¤æ¢ä¸¤ä¸ªä½ç½®çš„å€¼ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var mutableArray = [1, 2, 3, 4]</span><br><span class="line">mutableArray.swapAt(1, 2)</span><br><span class="line">print(mutableArray)</span><br><span class="line">// æ‰“å°ç»“æœï¼š[1, 3, 2, 4]</span><br></pre></td></tr></table></figure>

<h1 id="å››ã€æ„å»ºè¿‡ç¨‹æ”¹è¿›"><a href="#å››ã€æ„å»ºè¿‡ç¨‹æ”¹è¿›" class="headerlink" title="å››ã€æ„å»ºè¿‡ç¨‹æ”¹è¿›"></a>å››ã€æ„å»ºè¿‡ç¨‹æ”¹è¿›</h1><h2 id="New-Build-System"><a href="#New-Build-System" class="headerlink" title="New Build System"></a>New Build System</h2><p>Xcode 9 å¼•å…¥äº† New Build Systemï¼Œå¯åœ¨ Xcode 9 çš„ <code>File -&gt; Project Settings...</code> ä¸­é€‰æ‹©å¼€å¯ã€‚</p>
<p><img src="http://or9vkv08s.bkt.clouddn.com/WechatIMG252.jpeg"></p>
<h2 id="é¢„ç¼–è¯‘-Bridging-Headers-æ–‡ä»¶"><a href="#é¢„ç¼–è¯‘-Bridging-Headers-æ–‡ä»¶" class="headerlink" title="é¢„ç¼–è¯‘ Bridging Headers æ–‡ä»¶"></a>é¢„ç¼–è¯‘ Bridging Headers æ–‡ä»¶</h2><p>å¯¹äº Swift å’Œ Objective-C æ··åˆçš„é¡¹ç›®ï¼ŒSwift è°ƒç”¨ Objective-C æ—¶ï¼Œéœ€è¦å»ºç«‹ä¸€ä¸ª Bridging Headers æ–‡ä»¶ï¼Œç„¶åæŠŠ Swift è¦è°ƒç”¨çš„ Objective-C ç±»çš„å¤´æ–‡ä»¶éƒ½å†™åœ¨é‡Œé¢ï¼Œç¼–è¯‘å™¨ä¼šè¯»å– Bridging Headers ä¸­çš„å¤´æ–‡ä»¶ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªåºå¤§çš„ Swift æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯è¿™äº›å¤´æ–‡ä»¶å†…çš„ API çš„ Swift ç‰ˆæœ¬ã€‚ç„¶åç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ¯ä¸€ä¸ª Swift æ–‡ä»¶æ—¶ï¼ŒæŠŠè¿™ä¸ªåºå¤§çš„ Swift æ–‡ä»¶çš„å†…å®¹æ’å…¥è¿›å»ã€‚</p>
<p>æœ‰äº†é¢„ç¼–è¯‘ Bridging Headers ä»¥åï¼Œç¼–è¯‘å™¨ä¼šåœ¨é¢„ç¼–è¯‘é˜¶æ®µæŠŠ Bridging Headers ç¼–è¯‘ä¸€æ¬¡ï¼Œç„¶åæ’å…¥åˆ°æ¯ä¸ª Swift æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å°±å¤§å¤§æé«˜äº†ç¼–è¯‘é€Ÿåº¦ã€‚</p>
<p>Xcode 9 å’Œ Swift 4 å¯¹äº Swift å’Œ Objective-C æ··åˆç¼–è¯‘çš„é€Ÿåº¦æé«˜äº† 40%ã€‚</p>
<h2 id="Indexing-å¯ä»¥åœ¨ç¼–è¯‘çš„åŒæ—¶è¿›è¡Œ"><a href="#Indexing-å¯ä»¥åœ¨ç¼–è¯‘çš„åŒæ—¶è¿›è¡Œ" class="headerlink" title="Indexing å¯ä»¥åœ¨ç¼–è¯‘çš„åŒæ—¶è¿›è¡Œ"></a>Indexing å¯ä»¥åœ¨ç¼–è¯‘çš„åŒæ—¶è¿›è¡Œ</h2><p>ç”¨ Swift å¼€å‘é¡¹ç›®æ—¶ï¼Œè¿‘å‡ ä¸ªç‰ˆæœ¬çš„ Xcode è¿›è¡Œ Indexing çš„é€Ÿåº¦æ…¢çš„ä»¤äººå‘æŒ‡ã€‚Xcode 9 å’Œ Swift 4 åœ¨è¿™æ–¹é¢åšäº†ä¼˜åŒ–ï¼Œå¯ä»¥åœ¨ç¼–è¯‘çš„åŒæ—¶è¿›è¡Œ Indexingï¼Œä¸€èˆ¬ç¼–è¯‘ç»“æŸå Indexing ä¹Ÿä¼šåŒæ—¶å®Œæˆã€‚</p>
<h2 id="COW-Existential-Containers"><a href="#COW-Existential-Containers" class="headerlink" title="COW Existential Containers"></a>COW Existential Containers</h2><p>Swift ä¸­æœ‰ä¸ªä¸œè¥¿å« Existential Containersï¼Œå®ƒç”¨æ¥ä¿å­˜æœªçŸ¥ç±»å‹çš„å€¼ï¼Œå®ƒçš„å†…éƒ¨æ˜¯ä¸€ä¸ª Inline value bufferï¼Œå¦‚æœ Inline value buffer ä¸­çš„å€¼å ç”¨ç©ºé—´å¾ˆå¤§æ—¶ï¼Œè¿™ä¸ªå€¼ä¼šè¢«åˆ†é…åœ¨å †ä¸Šï¼Œç„¶è€Œåœ¨å †ä¸Šåˆ†é…å†…å­˜æ˜¯ä¸€ä¸ªæ€§èƒ½æ¯”è¾ƒæ…¢çš„æ“ä½œã€‚</p>
<p>Swift 4 ä¸­ä¸ºäº†ä¼˜åŒ–æ€§èƒ½å¼•å…¥äº† COW Existential Containersï¼Œè¿™é‡Œçš„ COW å°±ä»£è¡¨ â€œCopy-On-Writeâ€ï¼Œå½“å­˜åœ¨å¤šä¸ªç›¸åŒçš„å€¼æ—¶ï¼Œä»–ä»¬ä¼šå…±ç”¨ buffer ä¸Šçš„ç©ºé—´ï¼Œç›´åˆ°æŸä¸ªå€¼è¢«ä¿®æ”¹æ—¶ï¼Œè¿™ä¸ªè¢«ä¿®æ”¹çš„å€¼æ‰ä¼šè¢«æ‹·è´ä¸€ä»½å¹¶åˆ†é…å†…å­˜ç©ºé—´ã€‚</p>
<h2 id="ç§»é™¤æœªè°ƒç”¨çš„åè®®å®ç°"><a href="#ç§»é™¤æœªè°ƒç”¨çš„åè®®å®ç°" class="headerlink" title="ç§»é™¤æœªè°ƒç”¨çš„åè®®å®ç°"></a>ç§»é™¤æœªè°ƒç”¨çš„åè®®å®ç°</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">struct Date &#123;</span><br><span class="line">    private let secondsSinceReferenceDate: Double</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension Date: Equatable &#123;</span><br><span class="line">    static func ==(lhs: Date, rhs: Date) -&gt; Bool &#123;</span><br><span class="line">        return lhs.secondsSinceReferenceDate == rhs.secondsSinceReferenceDate</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension Date: Comparable &#123;</span><br><span class="line">    static func &lt;(lhs: Date, rhs: Date) -&gt; Bool &#123;</span><br><span class="line">        return lhs.secondsSinceReferenceDate &lt; rhs.secondsSinceReferenceDate</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸Šé¢ä¾‹å­ï¼ŒDate å®ç°äº† Equatable å’Œ Comparable åè®®ã€‚ç¼–è¯‘æ—¶å¦‚æœç¼–è¯‘å™¨å‘ç°æ²¡æœ‰ä»»ä½•åœ°æ–¹è°ƒç”¨äº†å¯¹ Date è¿›è¡Œå¤§å°æ¯”è¾ƒçš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šç§»é™¤ Comparable åè®®çš„å®ç°ï¼Œæ¥è¾¾åˆ°å‡å°åŒ…å¤§å°çš„ç›®çš„ã€‚</p>
<h2 id="å‡å°‘éšå¼-objc-è‡ªåŠ¨æ¨æ–­"><a href="#å‡å°‘éšå¼-objc-è‡ªåŠ¨æ¨æ–­" class="headerlink" title="å‡å°‘éšå¼ @objc è‡ªåŠ¨æ¨æ–­"></a>å‡å°‘éšå¼ @objc è‡ªåŠ¨æ¨æ–­</h2><p>åœ¨é¡¹ç›®ä¸­æƒ³æŠŠ Swift å†™çš„ API æš´éœ²ç»™ Objective-C è°ƒç”¨ï¼Œéœ€è¦å¢åŠ  @objcã€‚åœ¨ Swift 3 ä¸­ï¼Œç¼–è¯‘å™¨ä¼šåœ¨å¾ˆå¤šåœ°æ–¹ä¸ºæˆ‘ä»¬éšå¼çš„åŠ ä¸Š @objcï¼Œä¾‹å¦‚å½“ä¸€ä¸ªç±»ç»§æ‰¿äº NSObjectï¼Œé‚£ä¹ˆè¿™ä¸ªç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šè¢«éšå¼çš„åŠ ä¸Š @objcã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>: <span class="title class_">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">print</span>() &#123; <span class="operator">...</span> &#125; <span class="comment">// åŒ…å«éšå¼çš„ @objc</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">show</span>() &#123; <span class="operator">...</span> &#125; <span class="comment">// åŒ…å«éšå¼çš„ @objc</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¾ˆå¤šå¹¶ä¸éœ€è¦æš´éœ²ç»™ Objective-C ä¹Ÿè¢«åŠ ä¸Šäº† @objcã€‚å¤§é‡ @objc ä¼šå¯¼è‡´äºŒè¿›åˆ¶æ–‡ä»¶å¤§å°çš„å¢åŠ ã€‚</p>
<p>åœ¨ Swift 4 ä¸­ï¼Œéšå¼ @objc è‡ªåŠ¨æ¨æ–­åªä¼šå‘ç”Ÿåœ¨å¾ˆå°‘çš„å½“å¿…é¡»è¦ä½¿ç”¨ @objc çš„æƒ…å†µï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li>å¤å†™çˆ¶ç±»çš„ Objective-C æ–¹æ³•</li>
<li>ç¬¦åˆä¸€ä¸ª Objective-C çš„åè®®</li>
</ol>
<p>å…¶å®ƒå¤§å¤šæ•°åœ°æ–¹å¿…é¡»æ‰‹å·¥æ˜¾ç¤ºçš„åŠ ä¸Š @objcã€‚</p>
<p>å‡å°‘äº†éšå¼ @objc è‡ªåŠ¨æ¨æ–­åï¼ŒApple Music app çš„åŒ…å¤§å°å‡å°‘äº† 5.7%ã€‚</p>
<h1 id="äº”ã€-Exclusive-Access-to-Memory"><a href="#äº”ã€-Exclusive-Access-to-Memory" class="headerlink" title="äº”ã€ Exclusive Access to Memory"></a>äº”ã€ Exclusive Access to Memory</h1><p>åœ¨éå†ä¸€ä¸ª Collection çš„æ—¶å€™å¯ä»¥å»ä¿®æ”¹æ¯ä¸€ä¸ªå…ƒç´ çš„æŒ‡ï¼Œä½†æ˜¯åœ¨éå†æ—¶å¦‚æœå»æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªå…ƒç´ å°±å¯èƒ½ä¼šå¼•èµ· Crashã€‚</p>
<p>ä¾‹å¦‚ä¸º MutableCollection æ‰©å±•ä¸€ä¸ª modifyEach æ–¹æ³•æ¥ä¿®æ”¹æ¯ä¸ªå…ƒç´ çš„å€¼ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">MutableCollection</span> &#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">modifyEach</span>(<span class="keyword">_</span> <span class="params">body</span>: (<span class="keyword">inout</span> <span class="type">Element</span>) -&gt; ()) &#123;</span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> <span class="keyword">self</span>.indices &#123;</span><br><span class="line">            body(<span class="operator">&amp;</span><span class="keyword">self</span>[index])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡å¦‚åœ¨è°ƒç”¨ modifyEach æ—¶å»åˆ é™¤å…ƒç´ ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var numbers = [1, 2, 3]</span><br><span class="line">numbers.modifyEach &#123; element in</span><br><span class="line">    element *= 2</span><br><span class="line">    numbers.removeAll()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°±ä¼šåœ¨è¿è¡Œæ—¶ Crashã€‚Swift 4 ä¸­å¼•å…¥äº† Exclusive Access to Memoryï¼Œæ˜¯çš„è¿™ä¸ªé”™è¯¯å¯ä»¥åœ¨ç¼–è¯‘æ—¶è¢«æ£€æŸ¥å‡ºæ¥ã€‚</p>
<h1 id="å…­ã€-å…¶å®ƒ"><a href="#å…­ã€-å…¶å®ƒ" class="headerlink" title="å…­ã€ å…¶å®ƒ"></a>å…­ã€ å…¶å®ƒ</h1><h2 id="å…¼å®¹æ€§"><a href="#å…¼å®¹æ€§" class="headerlink" title="å…¼å®¹æ€§"></a>å…¼å®¹æ€§</h2><p>Xcode 9 ä¸­åŒæ—¶é›†æˆäº† Swift 3.2 å’Œ Swift 4ã€‚</p>
<ol>
<li>Swift 3.2 å®Œå…¨å…¼å®¹ Swift 3.1ï¼Œå¹¶ä¼šåœ¨è¿‡æ—¶çš„è¯­æ³•æˆ–å‡½æ•°ä¸ŠæŠ¥å‘Šè­¦å‘Šã€‚</li>
<li>Swift 3.2 å…·æœ‰ Swift 4 çš„ä¸€äº›å†™æ³•ï¼Œä½†æ˜¯æ€§èƒ½ä¸å¦‚ Swift 4ã€‚</li>
<li>Swift 3.2 å’Œ Swift 4 å¯ä»¥æ··åˆç¼–è¯‘ï¼Œå¯ä»¥æŒ‡å®šä¸€éƒ¨åˆ†æ¨¡å—ç”¨ Swift 3.2 ç¼–è¯‘ï¼Œä¸€éƒ¨åˆ†ç”¨ Swift 4 ç¼–è¯‘ã€‚</li>
<li>è¿ç§»åˆ° Swift 4 åèƒ½è·å¾— Swift 4 æ‰€æœ‰çš„æ–°ç‰¹æ€§ï¼Œå¹¶ä¸”æ€§èƒ½æ¯” Swift 3.2 å¥½ã€‚</li>
</ol>
<p>æ€»ç»“ï¼šå½“ Xcode æ­£å¼ç‰ˆå‘å¸ƒåï¼Œç°æœ‰çš„ Swift ä»£ç å¯ä»¥ç›´æ¥å‡çº§åˆ° Swift 3.2 è€Œä¸ç”¨åšä»»ä½•æ”¹åŠ¨ï¼Œåç»­å¯ä»¥å†è¿ç§»åˆ° Swift 4ã€‚æˆ–è€…ç›´æ¥è¿ç§»åˆ° Swift 4 ä¹Ÿå¯ä»¥ï¼ŒSwift 4 ç›¸æ¯” Swift 3 çš„ API å˜åŒ–è¿˜æ˜¯ä¸å¤§çš„ï¼Œå¾ˆå¤šç¬¬ä¸‰æ–¹åº“éƒ½å¯ä»¥ç›´æ¥ç”¨ Swift 4 ç¼–è¯‘ã€‚</p>
<h2 id="Symbol-Size"><a href="#Symbol-Size" class="headerlink" title="Symbol Size"></a>Symbol Size</h2><p>Swift 4 çš„ Symbol Size è¦æ¯” Swift 3 å‡å°‘äº†ä¸‰åˆ†ä¹‹äºŒã€‚</p>
<h1 id="ä¸ƒã€å‚è€ƒèµ„æ–™"><a href="#ä¸ƒã€å‚è€ƒèµ„æ–™" class="headerlink" title="ä¸ƒã€å‚è€ƒèµ„æ–™"></a>ä¸ƒã€å‚è€ƒèµ„æ–™</h1><ul>
<li>WWDC 2017 Session 402 ã€ŠWhatâ€™s New in Swiftã€‹</li>
<li>WWDC 2017 Session 212 ã€ŠWhatâ€™s New in Foundationã€‹</li>
<li>WWDC 2017 Session 102 ã€ŠPlatforms State of the Unionã€‹</li>
<li>ã€ŠSwift Language Programming (Swift 4.0)ã€‹</li>
<li><a target="_blank" rel="noopener" href="https://github.com/apple/swift-evolution">https://github.com/apple/swift-evolution</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ole/whats-new-in-swift-4">https://github.com/ole/whats-new-in-swift-4</a></li>
<li><a target="_blank" rel="noopener" href="https://www.raywenderlich.com/163857/whats-new-swift-4">https://www.raywenderlich.com/163857/whats-new-swift-4</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hackingwithswift.com/swift4">https://www.hackingwithswift.com/swift4</a></li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/sequence_advanced/" rel="next" title="Swift ä¸­çš„ Sequenceï¼ˆäºŒï¼‰">
                <i class="fa fa-chevron-left"></i> Swift ä¸­çš„ Sequenceï¼ˆäºŒï¼‰
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/weird_objectivec/" rel="prev" title="Objective-C å¥‡è‘©å†™æ³•åˆé›†">
                Objective-C å¥‡è‘©å†™æ³•åˆé›† <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/%7C%7C%20archive">
                
                    <span class="site-state-item-count">32</span>
                    <span class="site-state-item-name">æ—¥å¿—</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">åˆ†ç±»</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">æ ‡ç­¾</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E8%AF%AD%E6%B3%95%E6%94%B9%E8%BF%9B"><span class="nav-number">1.</span> <span class="nav-text">ä¸€ã€è¯­æ³•æ”¹è¿›</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#extension-%E4%B8%AD%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE-private-%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">1.1.</span> <span class="nav-text">extension ä¸­å¯ä»¥è®¿é—® private çš„å±æ€§</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%BB%84%E5%90%88%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">ç±»å‹å’Œåè®®çš„ç»„åˆç±»å‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Associated-Type-%E5%8F%AF%E4%BB%A5%E8%BF%BD%E5%8A%A0-Where-%E7%BA%A6%E6%9D%9F%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.3.</span> <span class="nav-text">Associated Type å¯ä»¥è¿½åŠ  Where çº¦æŸè¯­å¥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B0%E7%9A%84-Key-Paths-%E8%AF%AD%E6%B3%95"><span class="nav-number">1.4.</span> <span class="nav-text">æ–°çš„ Key Paths è¯­æ³•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8B%E6%A0%87%E6%94%AF%E6%8C%81%E6%B3%9B%E5%9E%8B"><span class="nav-number">1.5.</span> <span class="nav-text">ä¸‹æ ‡æ”¯æŒæ³›å‹</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">2.</span> <span class="nav-text">äºŒã€å­—ç¬¦ä¸²</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Unicode-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%9C%A8%E8%AE%A1%E7%AE%97-count-%E6%97%B6%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%80%A7%E6%94%B9%E5%96%84"><span class="nav-number">2.1.</span> <span class="nav-text">Unicode å­—ç¬¦ä¸²åœ¨è®¡ç®— count æ—¶çš„æ­£ç¡®æ€§æ”¹å–„</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E5%BF%AB%E7%9A%84%E5%AD%97%E7%AC%A6%E5%A4%84%E7%90%86%E9%80%9F%E5%BA%A6"><span class="nav-number">2.2.</span> <span class="nav-text">æ›´å¿«çš„å­—ç¬¦å¤„ç†é€Ÿåº¦</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%BB%E6%8E%89-characters"><span class="nav-number">2.3.</span> <span class="nav-text">å»æ‰ characters</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#One-sided-Slicing"><span class="nav-number">2.4.</span> <span class="nav-text">One-sided Slicing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#String-%E5%BD%93%E5%81%9A-Collection-%E6%9D%A5%E7%94%A8"><span class="nav-number">2.5.</span> <span class="nav-text">String å½“åš Collection æ¥ç”¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Substring"><span class="nav-number">2.6.</span> <span class="nav-text">Substring</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E8%A1%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%97%E9%9D%A2%E9%87%8F"><span class="nav-number">2.7.</span> <span class="nav-text">å¤šè¡Œå­—ç¬¦ä¸²å­—é¢é‡</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81Swift-%E6%A0%87%E5%87%86%E5%BA%93"><span class="nav-number">3.</span> <span class="nav-text">ä¸‰ã€Swift æ ‡å‡†åº“</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Encoding-and-Decoding"><span class="nav-number">3.1.</span> <span class="nav-text">Encoding and Decoding</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sequence-%E6%94%B9%E8%BF%9B"><span class="nav-number">3.2.</span> <span class="nav-text">Sequence æ”¹è¿›</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Protocol-oriented-integers"><span class="nav-number">3.3.</span> <span class="nav-text">Protocol-oriented integers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dictionary-and-Set-enhancements"><span class="nav-number">3.4.</span> <span class="nav-text">Dictionary and Set enhancements</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NSNumber-bridging-and-Numeric-types"><span class="nav-number">3.5.</span> <span class="nav-text">NSNumber bridging and Numeric types</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MutableCollection-swapAt"><span class="nav-number">3.6.</span> <span class="nav-text">MutableCollection.swapAt(::)</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B%E6%94%B9%E8%BF%9B"><span class="nav-number">4.</span> <span class="nav-text">å››ã€æ„å»ºè¿‡ç¨‹æ”¹è¿›</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#New-Build-System"><span class="nav-number">4.1.</span> <span class="nav-text">New Build System</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%84%E7%BC%96%E8%AF%91-Bridging-Headers-%E6%96%87%E4%BB%B6"><span class="nav-number">4.2.</span> <span class="nav-text">é¢„ç¼–è¯‘ Bridging Headers æ–‡ä»¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Indexing-%E5%8F%AF%E4%BB%A5%E5%9C%A8%E7%BC%96%E8%AF%91%E7%9A%84%E5%90%8C%E6%97%B6%E8%BF%9B%E8%A1%8C"><span class="nav-number">4.3.</span> <span class="nav-text">Indexing å¯ä»¥åœ¨ç¼–è¯‘çš„åŒæ—¶è¿›è¡Œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#COW-Existential-Containers"><span class="nav-number">4.4.</span> <span class="nav-text">COW Existential Containers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A7%BB%E9%99%A4%E6%9C%AA%E8%B0%83%E7%94%A8%E7%9A%84%E5%8D%8F%E8%AE%AE%E5%AE%9E%E7%8E%B0"><span class="nav-number">4.5.</span> <span class="nav-text">ç§»é™¤æœªè°ƒç”¨çš„åè®®å®ç°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%8F%E5%B0%91%E9%9A%90%E5%BC%8F-objc-%E8%87%AA%E5%8A%A8%E6%8E%A8%E6%96%AD"><span class="nav-number">4.6.</span> <span class="nav-text">å‡å°‘éšå¼ @objc è‡ªåŠ¨æ¨æ–­</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81-Exclusive-Access-to-Memory"><span class="nav-number">5.</span> <span class="nav-text">äº”ã€ Exclusive Access to Memory</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81-%E5%85%B6%E5%AE%83"><span class="nav-number">6.</span> <span class="nav-text">å…­ã€ å…¶å®ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%BC%E5%AE%B9%E6%80%A7"><span class="nav-number">6.1.</span> <span class="nav-text">å…¼å®¹æ€§</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Symbol-Size"><span class="nav-number">6.2.</span> <span class="nav-text">Symbol Size</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">7.</span> <span class="nav-text">ä¸ƒã€å‚è€ƒèµ„æ–™</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æ™¨æ›¦å¾®å…‰</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="ç«™ç‚¹æ€»å­—æ•°">146k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="ç«™ç‚¹æ€»é˜…è¯»æ—¶é•¿">2:26</span>
  
</div>




  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Mist</a> v6.0.2</div>





        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.2"></script>



  



	





  





  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'krbUxLGKWA6SjK4bKeeJcu8Q-gzGzoHsz',
        appKey: 'G2GNz7MLppJZuew6PZbdiZhf',
        placeholder: 'å¡«å†™è¯„è®ºå†…å®¹',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("nGSnOI7jqHLeho9asFx6j3b9-gzGzoHsz", "r6e5CNQIXNTbVb7KFX4R5rxk");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  
  

  

  

  

  

</body>
</html>
